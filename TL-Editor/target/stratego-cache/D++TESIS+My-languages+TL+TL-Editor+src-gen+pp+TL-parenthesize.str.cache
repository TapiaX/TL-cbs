Module("pp/TL-parenthesize",[Imports([Import("libstratego-lib"),ImportWildcard("signatures")]),Strategies([SDefNoArgs("io-TL-parenthesize",Call(SVar("io-wrap"),[CallNoArgs(SVar("parenthesize-TL"))])),SDefNoArgs("parenthesize-TL",Seq(Call(SVar("innermost"),[CallNoArgs(SVar("TLParenthesize"))]),Call(SVar("innermost"),[CallNoArgs(SVar("TLParenthesize-deep"))]))),SDefT("get-term-sort",[],[DefaultVarDec("t")],LChoice(Prim("\"SSL_EXT_get_sort_imploder_attachment\"",[RootApp(Id)]),Build(NoAnnoList(Str("\"unknown\"")))))]),Rules([RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("L-aexp--L-aexp-PLUS-L-aexp",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("L-aexp--L-aexp-PLUS-L-aexp",[Var("t_0"),NoAnnoList(Op("Parenthetical",[Var("t_1")]))])),BA(Choice(Match(NoAnnoList(Op("L-aexp--L-aexp-PLUS-L-aexp",[Wld,Wld]))),Fail),Var("t_1")))),RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("L-bexp--L-bexp-R-and-L-bexp",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("L-bexp--L-bexp-R-and-L-bexp",[Var("t_0"),NoAnnoList(Op("Parenthetical",[Var("t_1")]))])),BA(Choice(Match(NoAnnoList(Op("L-bexp--L-bexp-R-and-L-bexp",[Wld,Wld]))),Fail),Var("t_1")))),RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("FCTComputes",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("FCTComputes",[Var("t_0"),NoAnnoList(Op("Parenthetical",[Var("t_1")]))])),BA(Choice(Match(NoAnnoList(Op("FCTComputes",[Wld,Wld]))),Fail),Var("t_1")))),RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("FCTSequence",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("FCTSequence",[NoAnnoList(Op("Parenthetical",[Var("t_0")])),Var("t_1")])),BA(Choice(Match(NoAnnoList(Op("FCTSequence",[Wld,Wld]))),Fail),Var("t_0")))),RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("L-aexp--L-aexp-SLASH-L-aexp",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("L-aexp--L-aexp-SLASH-L-aexp",[NoAnnoList(Op("Parenthetical",[Var("t_0")])),Var("t_1")])),BA(Choice(Match(NoAnnoList(Op("L-aexp--L-aexp-PLUS-L-aexp",[Wld,Wld]))),Fail),Var("t_0")))),RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("L-aexp--L-aexp-SLASH-L-aexp",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("L-aexp--L-aexp-SLASH-L-aexp",[Var("t_0"),NoAnnoList(Op("Parenthetical",[Var("t_1")]))])),BA(Choice(Match(NoAnnoList(Op("L-aexp--L-aexp-PLUS-L-aexp",[Wld,Wld]))),Choice(Match(NoAnnoList(Op("L-aexp--L-aexp-SLASH-L-aexp",[Wld,Wld]))),Fail)),Var("t_1")))),RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("FCTTyped",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("FCTTyped",[Var("t_0"),NoAnnoList(Op("Parenthetical",[Var("t_1")]))])),BA(Choice(Match(NoAnnoList(Op("FCTTyped",[Wld,Wld]))),Fail),Var("t_1")))),RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("L-bexp--R-no-L-bexp",[Var("t_0")])),NoAnnoList(Op("L-bexp--R-no-L-bexp",[NoAnnoList(Op("Parenthetical",[Var("t_0")]))])),BA(Choice(Match(NoAnnoList(Op("L-bexp--L-exp-EQUALS-EQUALS-L-exp",[Wld,Wld]))),Fail),Var("t_0")))),RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("L-bexp--L-bexp-R-or-L-bexp",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("L-bexp--L-bexp-R-or-L-bexp",[Var("t_0"),NoAnnoList(Op("Parenthetical",[Var("t_1")]))])),BA(Choice(Match(NoAnnoList(Op("L-bexp--L-bexp-R-or-L-bexp",[Wld,Wld]))),Fail),Var("t_1")))),RDefNoArgs("TLParenthesize",Rule(NoAnnoList(Op("L-bexp--L-exp-EQUALS-EQUALS-L-exp",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("L-bexp--L-exp-EQUALS-EQUALS-L-exp",[Var("t_0"),NoAnnoList(Op("Parenthetical",[Var("t_1")]))])),BA(Choice(Match(NoAnnoList(Op("L-bexp--L-aexp-LESS-L-aexp",[Wld,Wld]))),Choice(Match(NoAnnoList(Op("L-bexp--L-aexp-GREATER-L-aexp",[Wld,Wld]))),Fail)),Var("t_1"))))]),Rules([RDefNoArgs("TLParenthesize-deep",Rule(NoAnnoList(Op("L-bexp--L-exp-EQUALS-EQUALS-L-exp",[Var("t_0"),Var("t_1")])),NoAnnoList(Op("L-bexp--L-exp-EQUALS-EQUALS-L-exp",[Var("t_0"),Var("t_1'")])),Assign(Var("t_1'"),App(Choice(Call(SVar("LeftContext"),[Choice(Match(NoAnnoList(Op("L-bexp--L-aexp-LESS-L-aexp",[Wld,Wld]))),Choice(Match(NoAnnoList(Op("L-bexp--L-aexp-GREATER-L-aexp",[Wld,Wld]))),Fail))]),Fail),Var("t_1")))))]),Rules([RDef("RightContext",[DefaultVarDec("s")],Rule(As(Var("t"),NoAnnoList(Explode(Var("cons"),Var(ListVar("args*"))))),NoAnnoList(Explode(Var("cons"),Var(ListVar("args'*")))),Seq(BA(Not(Match(NoAnnoList(List([])))),Var("cons")),Seq(BA(Not(Match(NoAnnoList(Op("Parenthetical",[Wld])))),Var("t")),Assign(Var(ListVar("args'*")),App(Call(SVar("at-last"),[LChoice(Call(SVar("RightContext"),[CallNoArgs(SVar("s"))]),Fail)]),Var(ListVar("args*")))))))),RDef("RightContext",[DefaultVarDec("s")],RuleNoCond(NoAnnoList(List([Var("t")])),NoAnnoList(List([App(Call(SVar("RightContext"),[CallNoArgs(SVar("s"))]),Var("t"))])))),RDef("RightContext",[DefaultVarDec("s")],Rule(Var("t"),NoAnnoList(Op("Parenthetical",[Var("t")])),Seq(BA(Not(CallNoArgs(SVar("is-list"))),Var("t")),BA(CallNoArgs(SVar("s")),Var("t"))))),RDef("LeftContext",[DefaultVarDec("s")],Rule(As(Var("t"),NoAnnoList(Explode(Var("cons"),Var(ListVar("args*"))))),NoAnnoList(Explode(Var("cons"),Var(ListVar("args'*")))),Seq(BA(Not(Match(NoAnnoList(List([])))),Var("cons")),Seq(BA(Not(Match(NoAnnoList(Op("Parenthetical",[Wld])))),Var("t")),Seq(Assign(Var("head"),App(Match(NoAnnoList(ListTail([RootApp(LChoice(Call(SVar("LeftContext"),[CallNoArgs(SVar("s"))]),Fail))],Var("hs")))),Var(ListVar("args*")))),Assign(Var(ListVar("args'*")),NoAnnoList(ListTail([Var("head")],Var("hs"))))))))),RDef("LeftContext",[DefaultVarDec("s")],RuleNoCond(NoAnnoList(List([Var("t")])),NoAnnoList(List([App(Call(SVar("LeftContext"),[CallNoArgs(SVar("s"))]),Var("t"))])))),RDef("LeftContext",[DefaultVarDec("s")],Rule(Var("t"),NoAnnoList(Op("Parenthetical",[Var("t")])),Seq(BA(Not(CallNoArgs(SVar("is-list"))),Var("t")),BA(CallNoArgs(SVar("s")),Var("t")))))]),Signature([Constructors([OpDecl("Parenthetical",FunType([ConstType(SortNoArgs("Unknown"))],ConstType(SortNoArgs("Unknown")))),OpDecl("Snoc",FunType([ConstType(SortNoArgs("Unknown")),ConstType(SortNoArgs("Unknown"))],ConstType(SortNoArgs("Unknown"))))])])])