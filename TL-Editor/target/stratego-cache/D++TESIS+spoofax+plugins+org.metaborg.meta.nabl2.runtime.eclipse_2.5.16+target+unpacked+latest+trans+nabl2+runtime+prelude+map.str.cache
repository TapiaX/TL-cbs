Module("nabl2/runtime/prelude/map",[Imports([Import("nabl2/runtime/prelude/base")]),Rules([SDefNoArgs("nabl2--keys",Call(SVar("map"),[CallNoArgs(SVar("Fst"))])),SDefNoArgs("nabl2--values",Call(SVar("map"),[CallNoArgs(SVar("Snd"))])),SDef("nabl2--mapv",[DefaultVarDec("s")],Call(SVar("map"),[Build(NoAnnoList(Tuple([RootApp(CallNoArgs(SVar("Fst"))),RootApp(Seq(CallNoArgs(SVar("Snd")),CallNoArgs(SVar("s"))))])))])),SDef("nabl2--filterv",[DefaultVarDec("s")],Call(SVar("filter"),[Build(NoAnnoList(Tuple([RootApp(CallNoArgs(SVar("Fst"))),RootApp(Seq(CallNoArgs(SVar("Snd")),CallNoArgs(SVar("s"))))])))])),SDef("nabl2--partitionv",[DefaultVarDec("s")],Call(SVar("partition"),[Build(NoAnnoList(Tuple([RootApp(CallNoArgs(SVar("Fst"))),RootApp(Seq(CallNoArgs(SVar("Snd")),CallNoArgs(SVar("s"))))])))])),SDef("nabl2--mapk",[DefaultVarDec("s")],Call(SVar("map"),[Build(NoAnnoList(Tuple([RootApp(Seq(CallNoArgs(SVar("Fst")),CallNoArgs(SVar("s")))),RootApp(CallNoArgs(SVar("Snd")))])))])),SDef("nabl2--filterk",[DefaultVarDec("s")],Call(SVar("filter"),[Build(NoAnnoList(Tuple([RootApp(Seq(CallNoArgs(SVar("Fst")),CallNoArgs(SVar("s")))),RootApp(CallNoArgs(SVar("Snd")))])))])),SDef("partitionk",[DefaultVarDec("s")],Call(SVar("partition"),[Build(NoAnnoList(Tuple([RootApp(Seq(CallNoArgs(SVar("Fst")),CallNoArgs(SVar("s")))),RootApp(CallNoArgs(SVar("Snd")))])))])),SDef("nabl2--mergemap",[DefaultVarDec("ks"),DefaultVarDec("vs")],Call(SVar("nabl2--strict"),[Seq(Match(NoAnnoList(Tuple([Var(ListVar("kv1*")),Var(ListVar("kv2*"))]))),Seq(BA(CallNoArgs(SVar("ks")),NoAnnoList(Tuple([App(CallNoArgs(SVar("nabl2--keys")),Var(ListVar("kv1*"))),App(CallNoArgs(SVar("nabl2--keys")),Var(ListVar("kv2*")))]))),Call(SVar("map"),[BA(Call(SVar("nabl2--merge-step"),[CallNoArgs(SVar("vs"))]),NoAnnoList(Tuple([RootApp(Id),Var(ListVar("kv1*")),Var(ListVar("kv2*"))])))])))])),SDef("nabl2--mergefilter",[DefaultVarDec("ks"),DefaultVarDec("vs")],Call(SVar("nabl2--strict"),[Seq(Match(NoAnnoList(Tuple([Var(ListVar("kv1*")),Var(ListVar("kv2*"))]))),Seq(BA(CallNoArgs(SVar("ks")),NoAnnoList(Tuple([App(CallNoArgs(SVar("nabl2--keys")),Var(ListVar("kv1*"))),App(CallNoArgs(SVar("nabl2--keys")),Var(ListVar("kv2*")))]))),Call(SVar("filter"),[BA(Call(SVar("nabl2--merge-step"),[CallNoArgs(SVar("vs"))]),NoAnnoList(Tuple([RootApp(Id),Var(ListVar("kv1*")),Var(ListVar("kv2*"))])))])))])),SDef("nabl2--merge-step",[DefaultVarDec("vs")],Seq(Match(NoAnnoList(Tuple([Var("k"),Var(ListVar("kv1*")),Var(ListVar("kv2*"))]))),Seq(GuardedLChoice(Assign(Var("v1"),App(CallNoArgs(SVar("lookup")),NoAnnoList(Tuple([Var("k"),Var(ListVar("kv1*"))])))),GuardedLChoice(Assign(Var("v2"),App(CallNoArgs(SVar("lookup")),NoAnnoList(Tuple([Var("k"),Var(ListVar("kv2*"))])))),BA(CallNoArgs(SVar("vs")),NoAnnoList(Tuple([Var("v1"),Var("v2")]))),Build(Var("v1"))),BA(CallNoArgs(SVar("lookup")),NoAnnoList(Tuple([Var("k"),Var(ListVar("kv2*"))])))),Build(NoAnnoList(Tuple([Var("k"),RootApp(Id)])))))),SDef("nabl2--group",[DefaultVarDec("s")],Call(SVar("foldr"),[Build(NoAnnoList(List([]))),Call(SVar("nabl2--group-step"),[CallNoArgs(SVar("s"))])])),SDef("nabl2--group-step",[DefaultVarDec("s")],Seq(Match(NoAnnoList(Tuple([Var("a"),Var(ListVar("kv*"))]))),Seq(AM(BA(CallNoArgs(SVar("s")),Var("a")),Var("b")),BA(CallT(SVar("nabl2--update"),[Build(NoAnnoList(ListTail([Var("a")],RootApp(Id)))),Build(NoAnnoList(List([])))],[Var("b")]),Var(ListVar("kv*")))))),SDefT("nabl2--update",[DefaultVarDec("s"),DefaultVarDec("v")],[DefaultVarDec("k")],Seq(Match(Var(ListVar("kv*"))),Build(NoAnnoList(ListTail([NoAnnoList(Tuple([Var("k"),App(Seq(LChoice(CallNoArgs(SVar("lookup")),CallNoArgs(SVar("v"))),CallNoArgs(SVar("s"))),NoAnnoList(Tuple([Var("k"),Var(ListVar("kv*"))])))]))],App(Call(SVar("nabl2--filterk"),[Not(Match(Var("k")))]),Var(ListVar("kv*")))))))),SDefT("nabl2--set",[DefaultVarDec("v")],[DefaultVarDec("k")],CallT(SVar("nabl2--update"),[CallNoArgs(SVar("v")),CallNoArgs(SVar("v"))],[Var("k")])),SDefT("nabl2--get",[],[DefaultVarDec("k")],BA(CallNoArgs(SVar("lookup")),NoAnnoList(Tuple([Var("k"),RootApp(Id)])))),SDefT("nabl2--getOr",[DefaultVarDec("v")],[DefaultVarDec("k")],LChoice(BA(CallNoArgs(SVar("lookup")),NoAnnoList(Tuple([Var("k"),RootApp(Id)]))),CallNoArgs(SVar("v"))))])])